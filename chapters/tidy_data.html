<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Practical tools for modern research - 4&nbsp; Tidy Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/data_bases.html" rel="next">
<link href="../chapters/data_manipulation.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/data_manipulation.html">Working with Data</a></li><li class="breadcrumb-item"><a href="../chapters/tidy_data.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tidy Data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Practical tools for modern research</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/nikitoshina/quarto_book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Set up</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Working with Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data_manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/tidy_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tidy Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data_bases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relational Databases</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data_validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Optimizing Data Validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Imputation</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#example" id="toc-example" class="nav-link active" data-scroll-target="#example"><span class="header-section-number">4.1</span> Example</a></li>
  <li><a href="#pivot_longer" id="toc-pivot_longer" class="nav-link" data-scroll-target="#pivot_longer"><span class="header-section-number">4.2</span> <code>pivot_longer()</code></a></li>
  <li><a href="#pivot_wider" id="toc-pivot_wider" class="nav-link" data-scroll-target="#pivot_wider"><span class="header-section-number">4.3</span> <code>pivot_wider()</code></a></li>
  <li><a href="#separate-and-unite" id="toc-separate-and-unite" class="nav-link" data-scroll-target="#separate-and-unite"><span class="header-section-number">4.4</span> <code>separate()</code> and <code>unite()</code></a></li>
  <li><a href="#tibble-and-tribble" id="toc-tibble-and-tribble" class="nav-link" data-scroll-target="#tibble-and-tribble"><span class="header-section-number">4.5</span> <code>tibble()</code> and <code>tribble()</code></a></li>
  <li>
<a href="#janitor-clean-your-data" id="toc-janitor-clean-your-data" class="nav-link" data-scroll-target="#janitor-clean-your-data"><span class="header-section-number">4.6</span> <code>janitor</code>: Clean Your Data</a>
  <ul class="collapse">
<li><a href="#clean_names" id="toc-clean_names" class="nav-link" data-scroll-target="#clean_names"><span class="header-section-number">4.6.1</span> <code>clean_names()</code></a></li>
  <li><a href="#remove_empty" id="toc-remove_empty" class="nav-link" data-scroll-target="#remove_empty"><span class="header-section-number">4.6.2</span> <code>remove_empty()</code></a></li>
  <li><a href="#remove_constant" id="toc-remove_constant" class="nav-link" data-scroll-target="#remove_constant"><span class="header-section-number">4.6.3</span> <code>remove_constant()</code></a></li>
  <li><a href="#convert_to_date-and-convert_to_datetime" id="toc-convert_to_date-and-convert_to_datetime" class="nav-link" data-scroll-target="#convert_to_date-and-convert_to_datetime"><span class="header-section-number">4.6.4</span> <code>convert_to_date()</code> and <code>convert_to_datetime()</code></a></li>
  <li><a href="#row_to_names" id="toc-row_to_names" class="nav-link" data-scroll-target="#row_to_names"><span class="header-section-number">4.6.5</span> <code>row_to_names()</code></a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.7</span> Summary</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/nikitoshina/quarto_book/edit/main/chapters/tidy_data.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/nikitoshina/quarto_book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tidy Data</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">
<style type="text/css">
.output {
max-height: 300px;
overflow-y: scroll;
}
</style>
</div>
<p>Tidy data is a standard way of structuring a dataset to streamline its usability. This standard, as popularized by Hadley Wickham <span class="citation" data-cites="wickhamTidyData2014">(<a href="#ref-wickhamTidyData2014" role="doc-biblioref">Wickham 2014</a>)</span>, depends on the organization of rows, columns, and tables, and how they correspond to observations, variables, and types.</p>
<div class="no-row-height column-margin column-container"><div id="ref-wickhamTidyData2014" class="csl-entry" role="listitem">
Wickham, Hadley. 2014. <span>“Tidy <span>Data</span>.”</span> <em>Journal of Statistical Software</em> 59 (10). <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div></div><p>In the context of Tidy Data:</p>
<ol type="1">
<li><p>Each variable is represented by a column.</p></li>
<li><p>Each observation is represented by a row.</p></li>
<li>
<p>Each type of observational unit is represented by a table.</p>
<blockquote class="blockquote">
<p>What changes put it in a column</p>
</blockquote>
</li>
</ol>
<p>Data commonly takes two formats: wide and long.</p>
<p>Wide data, also referred to as unstacked data, is structured so that each row represents an individual unit of observation, and each column represents a variable. This format is often employed when the number of variables is relatively small, and they don’t share hierarchical relationships. This format is common in reports, where its readability excels. A notable example of wide data is a panel where columns correspond to years <a href="#tbl-widepanel">Table&nbsp;<span class="quarto-unresolved-ref">tbl-widepanel</span></a>.</p>
<p>In contrast, long data, also known as stacked data, is organized so that each row represents a single observation of a variable, with columns representing the variable and the unit of observation identifier. This format is usually employed when the number of variables is large or they are hierarchically related. You’ll often find that working with long data is much more manageable for conducting analyses.</p>
<div id="tbl-panel" class="tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;4.1: Panel Data</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-widepanel" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(a) Wide Format</caption>
<thead><tr class="header">
<th style="text-align: left;"><strong>Country</strong></th>
<th style="text-align: left;"><strong>2020</strong></th>
<th style="text-align: left;"><strong>2021</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">329.5</td>
<td style="text-align: left;">331.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">144.1</td>
<td style="text-align: left;">143.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">126</td>
<td style="text-align: left;">126.7</td>
</tr>
</tbody>
</table>
</div>
<div id="tbl-longpanel" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(b) Tidy Long Format</caption>
<thead><tr class="header">
<th style="text-align: left;"><strong>Country</strong></th>
<th style="text-align: left;"><strong>Year</strong></th>
<th style="text-align: left;"><strong>Population</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">2020</td>
<td style="text-align: left;">329.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">2020</td>
<td style="text-align: left;">144.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">2020</td>
<td style="text-align: left;">126</td>
</tr>
<tr class="even">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">2021</td>
<td style="text-align: left;">331.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">2021</td>
<td style="text-align: left;">143.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">2021</td>
<td style="text-align: left;">126.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>From the first example, one might think that long and tidy data are synonyms. Let’s consider another example where we wish to make our data wider. In <a href="#tbl-across2">Table&nbsp;<span class="quarto-unresolved-ref">tbl-across2</span></a>, each observation—which comprises a country, its population, and birth rate—is spread across two rows. In this case, we aim to widen our data.</p>
<div id="tbl-widen" class="tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;4.2: Messy Long</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-across2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-widen" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(a) Across Two Rows</caption>
<thead><tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">Population</td>
<td style="text-align: left;">329.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">Population</td>
<td style="text-align: left;">144.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">Population</td>
<td style="text-align: left;">126</td>
</tr>
<tr class="even">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">Birth Rate</td>
<td style="text-align: left;">1.64</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">Birth Rate</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">Birth Rate</td>
<td style="text-align: left;">1.9</td>
</tr>
</tbody>
</table>
</div>
<div id="tbl-tidywide" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-widen" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(b) Tidy Wide</caption>
<thead><tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: left;">Population</th>
<th style="text-align: left;">Birth Rate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">329.5</td>
<td style="text-align: left;">1.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">144.1</td>
<td style="text-align: left;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">126</td>
<td style="text-align: left;">1.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Another common issue with messy data occurs when two variables are combined into one column, as seen in <a href="#tbl-gathered">Table&nbsp;<span class="quarto-unresolved-ref">tbl-gathered</span></a>, where ‘Year’ and ‘Population’ are in the same column. These need to be separated into two distinct columns: ‘Year’ and ‘Population’.</p>
<div id="tbl-gathersplit" class="tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;4.3: Separate Data</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-gathered" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-gathersplit" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(a) United Year/Population</caption>
<thead><tr class="header">
<th style="text-align: left;"><strong>Country</strong></th>
<th style="text-align: left;"><strong>Year/Population</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">2020/329.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">2020/144.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">2020/126</td>
</tr>
<tr class="even">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">2021/331.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">2021/143.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">2021/126.7</td>
</tr>
</tbody>
</table>
</div>
<div id="tbl-split" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-gathersplit" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(b) Tidy Split into Columns</caption>
<thead><tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: left;">Year</th>
<th style="text-align: left;">Population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">2020</td>
<td style="text-align: left;">329.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">2020</td>
<td style="text-align: left;">144.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">2020</td>
<td style="text-align: left;">126</td>
</tr>
<tr class="even">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">2021</td>
<td style="text-align: left;">331.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">2021</td>
<td style="text-align: left;">143.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">2021</td>
<td style="text-align: left;">126.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="example" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="example">
<span class="header-section-number">4.1</span> Example</h2>
<p>Tidy data is more than a theoretical concept; it has practical implications for data structuring. Consider this example of storing data on experiment payments:</p>
<p><img src="images/tidy_example1.png" class="img-fluid"></p>
<p>When a computer reads this data, it can’t understand our intent, so all columns are read as-is. Adding multiple days necessitates creating similar tables, increasing the chances of errors. Want a total for the entire experiment? We’d have to manually sum all cells. Now, compare this to:</p>
<p><img src="images/tidy_example2.png" class="img-fluid"></p>
<p>In this format, data input is straightforward, and generating summary tables is as simple as creating a pivot table. A tidy data approach from the outset aids in creating robust tables and saves time during analysis.</p>
</section><section id="pivot_longer" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="pivot_longer">
<span class="header-section-number">4.2</span> <code>pivot_longer()</code>
</h2>
<p>A common problem arises in datasets where column names are not variable names, but <em>values</em> of a variable. This is the case for <code>pr_correct</code>, <code>tr_correct</code>, <code>ch_correct</code>, where the column names represent the <code>game</code> variable’s name. Meanwhile, the values in the columns represent the number of correct answers, and each row denotes two observations, not one.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">data_raven</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/nikitoshina/ECON-623-Lab-2023/main/data/mexico_sample_data.csv?token=GHSAT0AAAAAAB5WTPULI26TZP545VNUFQE6Y6O4XVA"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">mean_temp_celsius</span>, <span class="va">gender</span>, <span class="va">pr_correct</span>, <span class="va">tr_correct</span>, <span class="va">ch_tournament</span>, <span class="va">ch_correct</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 114 × 7
   id    mean_temp_celsius gender pr_correct tr_correct ch_tournament ch_correct
   &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
 1 0010…              28.6 Female          7          3             1          9
 2 0010…              28.6 Male            5          6             0          4
 3 0010…              28.6 Male            6          7             0          7
 4 0010…              28.6 Male            1          5             1          7
 5 0010…              28.6 Male            7          9             1         10
 6 0010…              28.6 Female          2          7             0          5
 7 0010…              28.6 Female          6          6             0          7
 8 0010…              28.6 Female          7          7             0          6
 9 0010…              30.7 Female          5          4             0          4
10 0010…              30.7 Male            6          7             1          4
# ℹ 104 more rows</code></pre>
</div>
</div>
<p>To tidy such a dataset, we need to pivot the problematic columns into a new pair of variables. This operation requires:</p>
<ol type="1">
<li>The columns whose names are values, not variables—columns we want to pivot. In this case, <code>pr_correct</code>, <code>tr_correct</code>, <code>ch_correct</code>.</li>
<li>The name of the variable where we’ll move the column names. Here, it’s <code>game</code>. The default is <code>name</code>.</li>
<li>The name of the variable where we’ll move the column values. Here, it’s <code>n_correct</code>. The default is <code>value</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_raven</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pr_correct</span>, <span class="va">tr_correct</span>, <span class="va">ch_correct</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"game"</span>, values_to <span class="op">=</span> <span class="st">"n_correct"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">game</span>, <span class="va">n_correct</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  id        game       n_correct
  &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
1 001018001 pr_correct         7
2 001018001 tr_correct         3
3 001018001 ch_correct         9
4 001018002 pr_correct         5
5 001018002 tr_correct         6</code></pre>
</div>
</div>
</section><section id="pivot_wider" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="pivot_wider">
<span class="header-section-number">4.3</span> <code>pivot_wider()</code>
</h2>
<p><code>pivot_wider()</code> is the opposite of <code>pivot_longer()</code>. It is used when an observation is scattered across multiple rows. For instance, consider the <code>data_raven_accident</code> dataset, where <code>mean_temp_celsius</code> and <code>ch_tournament</code> are stacked. In this case, an observation is spread across two rows.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_raven_accident</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  id        name              value
  &lt;chr&gt;     &lt;chr&gt;             &lt;dbl&gt;
1 001018001 mean_temp_celsius  28.6
2 001018001 ch_tournament       1  
3 001018002 mean_temp_celsius  28.6
4 001018002 ch_tournament       0  
5 001018005 mean_temp_celsius  28.6</code></pre>
</div>
</div>
<p>To tidy this up, we need two parameters:</p>
<ol type="1">
<li>The column to take variable names from. Here, it’s <code>name</code>.</li>
<li>The column to take values from. Here it’s <code>value</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_raven_accident</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">name</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  id        mean_temp_celsius ch_tournament
  &lt;chr&gt;                 &lt;dbl&gt;         &lt;dbl&gt;
1 001018001              28.6             1
2 001018002              28.6             0
3 001018005              28.6             0
4 001018009              28.6             1
5 001018010              28.6             1</code></pre>
</div>
</div>
<p>It is evident from their names that <code>pivot_wider()</code> and <code>pivot_longer()</code> are inverse functions. <code>pivot_longer()</code> converts wide tables to a longer and narrower format, while <code>pivot_wider()</code> converts long tables to a shorter and wider format.</p>
</section><section id="separate-and-unite" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="separate-and-unite">
<span class="header-section-number">4.4</span> <code>separate()</code> and <code>unite()</code>
</h2>
<p>Sometimes, data may come with columns united, necessitating us to <code>separate()</code> them to maintain tidy data. The original function was superseded in favor of <code>separate_wider_position()</code> and <code>separate_wider_delim()</code>, there is also <code>separate_longer_*()</code> version.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_raven_sep</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  id        `gender/pr_correct`
  &lt;chr&gt;     &lt;chr&gt;              
1 001018001 Female/7           
2 001018002 Male/5             
3 001018005 Male/6             
4 001018009 Male/1             
5 001018010 Male/7             </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_raven_sep</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate_wider_delim</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gender/pr_correct"</span>, delim <span class="op">=</span> <span class="st">"/"</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"pr_correct"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  id        gender pr_correct
  &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;     
1 001018001 Female 7         
2 001018002 Male   5         
3 001018005 Male   6         
4 001018009 Male   1         
5 001018010 Male   7         </code></pre>
</div>
</div>
<p>What if we have one column that has been split across multiple columns? Consider a situation where our subject ID code, composed of site_id, session_n, and subject_n, has been broken down into three separate columns. In such a scenario, we would need to <code>unite()</code> these columns back into one.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_raven_uni</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  site_id session_n subject_n gender
  &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; 
1 001     018       001       Female
2 001     018       002       Male  
3 001     018       005       Male  
4 001     018       009       Male  
5 001     018       010       Male  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_raven_uni</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">unite</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">site_id</span>, <span class="va">session_n</span>, <span class="va">subject_n</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"id"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  id        gender
  &lt;chr&gt;     &lt;chr&gt; 
1 001018001 Female
2 001018002 Male  
3 001018005 Male  
4 001018009 Male  
5 001018010 Male  </code></pre>
</div>
</div>
</section><section id="tibble-and-tribble" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="tibble-and-tribble">
<span class="header-section-number">4.5</span> <code>tibble()</code> and <code>tribble()</code>
</h2>
<p>A tibble is a special kind of data frame in R. Tibbles are a modern re-imagining of the data frame, designed to be more friendly and consistent than traditional data frames. To create a tibble, we can use <code>tibble()</code>, similar to <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>. Here are some features that make tibbles unique:</p>
<ul>
<li><p>By default, tibbles display only the first 10 rows when printed, making them easier to work with large datasets.</p></li>
<li><p>They use a consistent printing format, making it easier to work with multiple tibbles in the same session.</p></li>
<li><p>Tibbles have a consistent subsetting behavior, making it easier to select columns by name. When printed, the data type of each column is specified.</p></li>
<li><p>Subsetting a tibble will always return a tibble, so you don’t need to use <code>drop = FALSE</code>, as you would with traditional data frames.</p></li>
<li><p>Most importantly, tibbles can have columns that consist of lists.</p></li>
</ul>
<p>In summary, Tibbles are a more modern and consistent version of data frames. They are less prone to errors and more readable, making them an excellent choice for data manipulation and exploration tasks.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
      x y    
  &lt;dbl&gt; &lt;chr&gt;
1     1 one  
2     2 two  
3     3 three</code></pre>
</div>
</div>
<p>You can also use <code>tribble()</code> to create a row-wise, readable tibble in R. This is especially useful when creating small tables of data. The syntax is as follows: <code>tribble(~column1, ~column2)</code>, where the Row column — represents the data in a row by row layout.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">x</span>, <span class="op">~</span><span class="va">y</span>,</span>
<span>  <span class="fl">1</span>, <span class="st">"one"</span>,</span>
<span>  <span class="fl">2</span>, <span class="st">"two"</span>,</span>
<span>  <span class="fl">3</span>, <span class="st">"three"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
      x y    
  &lt;dbl&gt; &lt;chr&gt;
1     1 one  
2     2 two  
3     3 three</code></pre>
</div>
</div>
</section><section id="janitor-clean-your-data" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="janitor-clean-your-data">
<span class="header-section-number">4.6</span> <code>janitor</code>: Clean Your Data</h2>
<p>The <code>janitor</code> package is designed to make the process of cleaning and tidying data as simple and efficient as possible. To learn more about the functions it provides, check out <a href="https://cran.r-project.org/web/packages/janitor/vignettes/janitor.html">this vignette</a>!</p>
<section id="clean_names" class="level3" data-number="4.6.1"><h3 data-number="4.6.1" class="anchored" data-anchor-id="clean_names">
<span class="header-section-number">4.6.1</span> <code>clean_names()</code>
</h3>
<p>The <code><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names()</a></code> function is used to clean variable names, especially those read in from Excel files using <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">readxl::read_excel()</a></code> and <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code>. It parses letter cases, separators, and special characters into a consistent format, converts certain characters like “%” to “percent” and “#” to “number” to retain meaning, and resolves issues of duplicate or empty names. It is recommended to call this function every time data is read.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a data.frame with dirty names</span></span>
<span><span class="va">test_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">test_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"camelCase"</span>, <span class="st">"ábc@!*"</span>, <span class="st">"% of respondents (2009)"</span>,</span>
<span>  <span class="st">"Duplicate"</span>, <span class="st">"Duplicate"</span>, <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="va">test_df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "camelCase"               "ábc@!*"                 
[3] "% of respondents (2009)" "Duplicate"              
[5] "Duplicate"               ""                       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="va">test_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "camel_case"                  "abc"                        
[3] "percent_of_respondents_2009" "duplicate"                  
[5] "duplicate_2"                 "x"                          </code></pre>
</div>
</div>
</section><section id="remove_empty" class="level3" data-number="4.6.2"><h3 data-number="4.6.2" class="anchored" data-anchor-id="remove_empty">
<span class="header-section-number">4.6.2</span> <code>remove_empty()</code>
</h3>
<p><code><a href="https://rdrr.io/pkg/janitor/man/remove_empty.html">remove_empty()</a></code> removes empty rows and columns, which is especially useful after reading Excel files.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  numbers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  food <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  letters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="cn">NA</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">test_df2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  numbers food letters
1       1   NA       a
2      NA   NA    &lt;NA&gt;
3       3   NA       c</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_df2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/remove_empty.html">remove_empty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rows"</span>, <span class="st">"cols"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  numbers letters
1       1       a
3       3       c</code></pre>
</div>
</div>
</section><section id="remove_constant" class="level3" data-number="4.6.3"><h3 data-number="4.6.3" class="anchored" data-anchor-id="remove_constant">
<span class="header-section-number">4.6.3</span> <code>remove_constant()</code>
</h3>
<p><code><a href="https://rdrr.io/pkg/janitor/man/remove_constant.html">remove_constant()</a></code> drops columns from a data.frame that contain only a single constant value (with an na.rm option to control whether <code>NAs</code> should be considered as different values from the constant).</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>cool_numbers <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, boring <span class="op">=</span> <span class="st">"the same"</span><span class="op">)</span></span>
<span><span class="va">test_df3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cool_numbers   boring
1            1 the same
2            2 the same
3            3 the same</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_df3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/remove_constant.html">remove_constant</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cool_numbers
1            1
2            2
3            3</code></pre>
</div>
</div>
</section><section id="convert_to_date-and-convert_to_datetime" class="level3" data-number="4.6.4"><h3 data-number="4.6.4" class="anchored" data-anchor-id="convert_to_date-and-convert_to_datetime">
<span class="header-section-number">4.6.4</span> <code>convert_to_date()</code> and <code>convert_to_datetime()</code>
</h3>
<p>Do you remember loading data from Excel and seeing <code>36922.75</code> instead of dates? Well, <code><a href="https://rdrr.io/pkg/janitor/man/convert_to_date.html">convert_to_date()</a></code> and <code><a href="https://rdrr.io/pkg/janitor/man/convert_to_date.html">convert_to_datetime()</a></code> will convert this format and other date-time formats to actual dates! If you need more customization, check <code><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/convert_to_date.html">convert_to_date</a></span><span class="op">(</span><span class="fl">36922.75</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2001-01-31"</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/convert_to_date.html">convert_to_datetime</a></span><span class="op">(</span><span class="fl">36922.75</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2001-01-31 18:00:00 UTC"</code></pre>
</div>
</div>
</section><section id="row_to_names" class="level3" data-number="4.6.5"><h3 data-number="4.6.5" class="anchored" data-anchor-id="row_to_names">
<span class="header-section-number">4.6.5</span> <code>row_to_names()</code>
</h3>
<p><code><a href="https://rdrr.io/pkg/janitor/man/row_to_names.html">row_to_names()</a></code> is a function that takes the names of variables stored in a row of a data frame and makes them the column names of the data frame. It can also remove the row that contained the names, and any rows above it, if desired.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_df4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Names"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  x_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Value"</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">test_df4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x_1   x_2
1  &lt;NA&gt;  &lt;NA&gt;
2 Names Value
3     1     4
4     2     5
5     3     6</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/row_to_names.html">row_to_names</a></span><span class="op">(</span><span class="va">test_df4</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Names Value
3     1     4
4     2     5
5     3     6</code></pre>
</div>
</div>
</section></section><section id="summary" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="summary">
<span class="header-section-number">4.7</span> Summary</h2>
<p>This chapter introduced the concept of tidy data, focusing on its structured format where each variable corresponds to a column, each observation to a row, and each observational unit type to a table. We highlighted the distinctions between wide and long data formats, and delved into practical R tools for organizing data into this tidy structure, including an overview of tibbles and additional resources for data cleaning. Understanding these principles of tidy data is invaluable and will prove beneficial throughout your career. Next, we will shift our focus to relational data and the concept of joins!</p>



</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/data_manipulation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Manipulation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/data_bases.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relational Databases</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>